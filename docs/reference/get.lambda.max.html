<!DOCTYPE html>
<!-- Generated by pkgdown: do not edit by hand --><html lang="en"><head><meta http-equiv="Content-Type" content="text/html; charset=UTF-8"><meta charset="utf-8"><meta http-equiv="X-UA-Compatible" content="IE=edge"><meta name="viewport" content="width=device-width, initial-scale=1.0"><title>Upper bound for spatio-temporal intensity models — get.lambda.max • SepTest</title><!-- jquery --><script src="https://cdnjs.cloudflare.com/ajax/libs/jquery/3.7.1/jquery.min.js" integrity="sha512-v2CJ7UaYy4JwqLDIrZUI/4hqeoQieOmAZNXBeQyjo21dadnwR+8ZaIJVT8EE2iyI61OV8e6M8PP2/4hpQINQ/g==" crossorigin="anonymous" referrerpolicy="no-referrer"></script><!-- Bootstrap --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/css/bootstrap.min.css" integrity="sha256-bZLfwXAP04zRMK2BjiO8iu9pf4FbLqX6zitd+tIvLhE=" crossorigin="anonymous"><script src="https://cdnjs.cloudflare.com/ajax/libs/twitter-bootstrap/3.4.1/js/bootstrap.min.js" integrity="sha256-nuL8/2cJ5NDSSwnKD8VqreErSWHtnEP9E7AySL+1ev4=" crossorigin="anonymous"></script><!-- bootstrap-toc --><link rel="stylesheet" href="../bootstrap-toc.css"><script src="../bootstrap-toc.js"></script><!-- Font Awesome icons --><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/all.min.css" integrity="sha256-mmgLkCYLUQbXn0B1SRqzHar6dCnv9oZFPEC1g1cwlkk=" crossorigin="anonymous"><link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/font-awesome/5.12.1/css/v4-shims.min.css" integrity="sha256-wZjR52fzng1pJHwx4aV2AO3yyTOXrcDW7jBpJtTwVxw=" crossorigin="anonymous"><!-- clipboard.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/clipboard.js/2.0.6/clipboard.min.js" integrity="sha256-inc5kl9MA1hkeYUt+EC3BhlIgyp/2jDIyBLS6k3UxPI=" crossorigin="anonymous"></script><!-- headroom.js --><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/headroom.min.js" integrity="sha256-AsUX4SJE1+yuDu5+mAVzJbuYNPHj/WroHuZ8Ir/CkE0=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/headroom/0.11.0/jQuery.headroom.min.js" integrity="sha256-ZX/yNShbjqsohH1k95liqY9Gd8uOiE1S4vZc+9KQ1K4=" crossorigin="anonymous"></script><!-- pkgdown --><link href="../pkgdown.css" rel="stylesheet"><script src="../pkgdown.js"></script><meta property="og:title" content="Upper bound for spatio-temporal intensity models — get.lambda.max"><meta property="og:description" content="Computes a practical upper bound for the spatio-temporal intensity models used in
get.lambda.function. The bound is intended for thinning/rejection sampling
in simulation routines such as rstpoispp."><!-- mathjax --><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/MathJax.js" integrity="sha256-nvJJv9wWKEm88qvoQl9ekL2J+k/RWIsaSScxxlsrv8k=" crossorigin="anonymous"></script><script src="https://cdnjs.cloudflare.com/ajax/libs/mathjax/2.7.5/config/TeX-AMS-MML_HTMLorMML.js" integrity="sha256-84DKXVJXs0/F8OTMzX4UR909+jtl4G7SPypPavF+GfA=" crossorigin="anonymous"></script><!--[if lt IE 9]>
<script src="https://oss.maxcdn.com/html5shiv/3.7.3/html5shiv.min.js"></script>
<script src="https://oss.maxcdn.com/respond/1.4.2/respond.min.js"></script>
<![endif]--></head><body data-spy="scroll" data-target="#toc">


    <div class="container template-reference-topic">
      <header><div class="navbar navbar-default navbar-fixed-top" role="navigation">
  <div class="container">
    <div class="navbar-header">
      <button type="button" class="navbar-toggle collapsed" data-toggle="collapse" data-target="#navbar" aria-expanded="false">
        <span class="sr-only">Toggle navigation</span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
        <span class="icon-bar"></span>
      </button>
      <span class="navbar-brand">
        <a class="navbar-link" href="../index.html">SepTest</a>
        <span class="version label label-default" data-toggle="tooltip" data-placement="bottom" title="">0.0.1</span>
      </span>
    </div>

    <div id="navbar" class="navbar-collapse collapse">
      <ul class="nav navbar-nav"><li>
  <a href="../reference/index.html">Reference</a>
</li>
      </ul><ul class="nav navbar-nav navbar-right"><li>
  <a href="https://github.com/mghorbani01/SepTest/" class="external-link">
    <span class="fab fa-github fa-lg"></span>

  </a>
</li>
      </ul></div><!--/.nav-collapse -->
  </div><!--/.container -->
</div><!--/.navbar -->



      </header><div class="row">
  <div class="col-md-9 contents">
    <div class="page-header">
    <h1>Upper bound for spatio-temporal intensity models</h1>
    <small class="dont-index">Source: <a href="https://github.com/mghorbani01/SepTest/blob/HEAD/R/get_lambda_max.R" class="external-link"><code>R/get_lambda_max.R</code></a></small>
    <div class="hidden name"><code>get.lambda.max.Rd</code></div>
    </div>

    <div class="ref-description">
    <p>Computes a practical upper bound for the spatio-temporal intensity models used in
<code><a href="get.lambda.function.html">get.lambda.function</a></code>. The bound is intended for thinning/rejection sampling
in simulation routines such as <code><a href="rstpoispp.html">rstpoispp</a></code>.</p>
    </div>

    <div id="ref-usage">
    <div class="sourceCode"><pre class="sourceCode r"><code><span><span class="fu">get.lambda.max</span><span class="op">(</span></span>
<span>  <span class="va">N</span>,</span>
<span>  <span class="va">g</span>,</span>
<span>  model <span class="op">=</span> <span class="fl">1L</span>,</span>
<span>  mu1 <span class="op">=</span> <span class="fl">0.5</span>,</span>
<span>  sd1 <span class="op">=</span> <span class="fl">0.2</span>,</span>
<span>  mu2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.5</span>, <span class="fl">0.5</span><span class="op">)</span>,</span>
<span>  sd2 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.2</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  mu3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.3</span>, <span class="fl">0.3</span>, <span class="fl">0.2</span><span class="op">)</span>,</span>
<span>  sd3 <span class="op">=</span> <span class="fu"><a href="https://rdrr.io/r/base/c.html" class="external-link">c</a></span><span class="op">(</span><span class="fl">0.05</span>, <span class="fl">0.05</span>, <span class="fl">0.05</span><span class="op">)</span></span>
<span><span class="op">)</span></span></code></pre></div>
    </div>

    <div id="arguments">
    <h2>Arguments</h2>


<dl><dt id="arg-n">N<a class="anchor" aria-label="anchor" href="#arg-n"></a></dt>
<dd><p>Numeric scalar (&gt; 0). Total expected number of events (baseline intensity level).</p></dd>


<dt id="arg-g">g<a class="anchor" aria-label="anchor" href="#arg-g"></a></dt>
<dd><p>Numeric scalar (&gt;= 0). Weight of the structured (non-separable) component.</p></dd>


<dt id="arg-model">model<a class="anchor" aria-label="anchor" href="#arg-model"></a></dt>
<dd><p>Integer in <code>1:4</code>. See <code><a href="get.lambda.function.html">get.lambda.function</a></code>.</p></dd>


<dt id="arg-mu-">mu1<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>Numeric scalar. Mean of the temporal Gaussian background term (models 2 and 4).</p></dd>


<dt id="arg-sd-">sd1<a class="anchor" aria-label="anchor" href="#arg-sd-"></a></dt>
<dd><p>Numeric scalar (&gt; 0). Standard deviation of the temporal Gaussian background term.</p></dd>


<dt id="arg-mu-">mu2<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>Numeric vector of length 2. Mean of the spatial Gaussian background term (models 3 and 4).</p></dd>


<dt id="arg-sd-">sd2<a class="anchor" aria-label="anchor" href="#arg-sd-"></a></dt>
<dd><p>Numeric vector of length 2 with positive entries. Standard deviations of the spatial background term.</p></dd>


<dt id="arg-mu-">mu3<a class="anchor" aria-label="anchor" href="#arg-mu-"></a></dt>
<dd><p>Numeric vector of length 3. Mean of the structured spatio-temporal Gaussian component.</p></dd>


<dt id="arg-sd-">sd3<a class="anchor" aria-label="anchor" href="#arg-sd-"></a></dt>
<dd><p>Numeric vector of length 3 with positive entries. Standard deviations of the structured component.</p></dd>

</dl></div>
    <div id="value">
    <h2>Value</h2>
    <p>Numeric scalar. A conservative upper bound for the selected intensity model.</p>
    </div>
    <div id="details">
    <h2>Details</h2>
    <p>The bound is computed using analytic maxima of Gaussian density components (at their modes),
which yields a conservative and fast-to-evaluate upper bound when the component functions are
Gaussian product densities.</p>
<p>The intensity models are mixtures of a background term and a structured spatio-temporal Gaussian bump.
This function returns an upper bound obtained by evaluating each Gaussian density component at its mode.
This upper bound is typically sufficient for rejection sampling when generating
realizations of inhomogeneous Poisson or Cox point processes.</p>
<p>If <code>norm2d</code> and <code>norm3d</code> in this package are Gaussian product densities (independent components),
then the maxima are available in closed form:</p><ul><li><p>\(\max_t \phi(t;\mu,\sigma) = 1/(\sigma\sqrt{2\pi})\)</p></li>
<li><p>\(\max_{x,y} \phi(x;\mu_x,\sigma_x)\phi(y;\mu_y,\sigma_y) = 1/(2\pi\sigma_x\sigma_y)\)</p></li>
<li><p>\(\max_{x,y,t} \prod_{d=1}^3 \phi(\cdot;\mu_d,\sigma_d) = 1/((2\pi)^{3/2}\sigma_x\sigma_y\sigma_t)\)</p></li>
</ul><p>If your <code>norm2d</code>/<code>norm3d</code> use a different parameterization, this bound should be updated accordingly.</p>
    </div>
    <div id="references">
    <h2>References</h2>
    <p>Ghorbani, M., Vafaei, N., Dvořák, J., and Myllymäki, M. (2021).
Testing the first-order separability hypothesis for spatio-temporal point patterns.
<em>Computational Statistics and Data Analysis</em>, <b>161</b>, 107245.</p>
    </div>
    <div id="see-also">
    <h2>See also</h2>
    <div class="dont-index"><p><code><a href="get.lambda.function.html">get.lambda.function</a></code>, <code><a href="rstpoispp.html">rstpoispp</a></code></p></div>
    </div>
    <div id="author">
    <h2>Author</h2>
    <p>Nafiseh Vafaei <a href="mailto:nafiseh.vafaei@slu.se">nafiseh.vafaei@slu.se</a><br>
Mohammad Ghorbani <a href="mailto:mohammad.ghorbani@slu.se">mohammad.ghorbani@slu.se</a></p>
    </div>

    <div id="ref-examples">
    <h2>Examples</h2>
    <div class="sourceCode"><pre class="sourceCode r"><code><span class="r-in"><span><span class="co"># Example 1: Homogeneous model (Model 1)</span></span></span>
<span class="r-in"><span><span class="fu">get.lambda.max</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, g <span class="op">=</span> <span class="fl">50</span>, model <span class="op">=</span> <span class="fl">1</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 25547.45</span>
<span class="r-in"><span></span></span>
<span class="r-in"><span><span class="co"># Example 2: Non-separable spatio-temporal model (Model 4)</span></span></span>
<span class="r-in"><span><span class="fu">get.lambda.max</span><span class="op">(</span>N <span class="op">=</span> <span class="fl">200</span>, g <span class="op">=</span> <span class="fl">50</span>, model <span class="op">=</span> <span class="fl">4</span><span class="op">)</span></span></span>
<span class="r-out co"><span class="r-pr">#&gt;</span> [1] 26587.96</span>
<span class="r-in"><span></span></span>
</code></pre></div>
    </div>
  </div>
  <div class="col-md-3 hidden-xs hidden-sm" id="pkgdown-sidebar">
    <nav id="toc" data-toggle="toc" class="sticky-top"><h2 data-toc-skip>Contents</h2>
    </nav></div>
</div>


      <footer><div class="copyright">
  <p></p><p>Developed by Mohammad Ghorbani.</p>
</div>

<div class="pkgdown">
  <p></p><p>Site built with <a href="https://pkgdown.r-lib.org/" class="external-link">pkgdown</a> 2.2.0.</p>
</div>

      </footer></div>






  </body></html>

